document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".industry-card");let s=document.getElementById("products-section"),c=document.getElementById("products-container"),i=document.querySelector(".loading-state"),d=document.getElementById("error-state"),l=document.getElementById("filter-controls"),t=document.getElementById("breadcrumb-category"),a="/shared_images/product_images/",o=document.getElementById("contact-modal");var r=document.querySelector(".modal-close");let u=e=>`
        <article class="product-card" role="listitem">
            <div class="product-header">
                ${e.primary_image?`<img src="${a}${e.primary_image}" 
                         alt="${e.name}" 
                         class="product-image"
                         loading="lazy">`:'<div class="image-placeholder">FÄƒrÄƒ imagine</div>'}
                <div class="product-badges">
                    ${e.subcategory_name?`<span class="badge subcategory-badge">${e.subcategory_name}</span>`:""}
                    <span class="badge category-badge">${e.category_name}</span>
                </div>
            </div>
            <div class="product-content">
                <h4 class="product-title">${e.name}</h4>
                
                ${e.short_description?`<p class="product-description">${e.short_description}</p>`:""}
                
                <div class="product-specs">
                    ${e.specifications?Object.entries(e.specifications).map(([e,t])=>`
                                <div class="spec-item">
                                    <span class="spec-label">${e}:</span>
                                    <span class="spec-value">${t}</span>
                                </div>
                            `).join(""):""}
                </div>
                
                ${e.key_features?`
                    <ul class="features-list">
                        ${e.key_features.map(e=>`<li class="feature-item">âœ“ ${e}</li>`).join("")}
                    </ul>`:""}
                
                <div class="product-actions">
                    <a href="product.php?id=${e.product_id}" 
                       class="btn-detalii"
                       aria-label="Vezi specificaÈ›ii complete pentru ${e.name}">
                        <span class="icon">ðŸ“‹</span>
                        SpecificaÈ›ii complete
                    </a>
                    <button class="btn-contact" 
                            onclick="showContactModal('${e.product_id}', '${e.name}')"
                            aria-label="SolicitÄƒ ofertÄƒ pentru ${e.name}">
                        <span class="icon">ðŸ’¬</span>
                        SolicitÄƒ ofertÄƒ
                    </button>
                </div>
            </div>
        </article>
    `;function n(){o&&(o.classList.remove("modal-open"),document.body.style.overflow="")}async function p(e){try{s.hidden=!1,i.hidden=!1,i.style.display="block",d.hidden=!0;var t=await fetch("includes/api/fetch_products.php?industry="+encodeURIComponent(e));if(!t.ok)throw new Error("Network response was not ok");var a=await t.json(),o=(n=a,c.innerHTML=n.length?n.map(u).join(""):'<p class="no-products">Nu existÄƒ produse Ã®n aceastÄƒ categorie.</p>',n),r=[...new Set(o.map(e=>e.subcategory_name).filter(Boolean))];l.innerHTML=r.length?`
            <label for="subcategory-filter">FiltreazÄƒ dupÄƒ subcategorie:</label>
            <select id="subcategory-filter" class="filter-dropdown">
                <option value="">Toate subcategoriile</option>
                ${r.map(e=>`<option value="${e}">${e}</option>`).join("")}
            </select>
        `:"",document.getElementById("subcategory-filter")?.addEventListener("change",function(t){var e=o.filter(e=>!t.target.value||e.subcategory_name===t.target.value);c.innerHTML=e.map(u).join("")})}catch(e){console.error("Fetch error:",e),d.hidden=!1}finally{i.hidden=!0,i.style.display="none"}var n}window.showContactModal=function(e,t){var a=document.getElementById("modal-product-name");o&&a&&(a.value=t,o.classList.add("modal-open"),document.body.style.overflow="hidden")},e.forEach(e=>{e.addEventListener("click",function(){var e=this.dataset.industry;t.textContent=e,document.querySelectorAll(".industry-card").forEach(e=>e.classList.remove("active")),this.classList.add("active"),s.hidden=!1,window.scrollTo({top:s.offsetTop-100,behavior:"smooth"}),p(e)})}),r?.addEventListener("click",n),o?.addEventListener("click",e=>{e.target===o&&n()}),document.querySelector(".retry-button")?.addEventListener("click",()=>{var e=document.querySelector(".industry-card.active")?.dataset.industry;e&&p(e)}),document.getElementById("contact-form")?.addEventListener("submit",async function(e){e.preventDefault();e=this.querySelector('button[type="submit"]');e.disabled=!0;try{var t=new FormData(this),a=await fetch(this.action,{method:"POST",body:t});if(!a.ok)throw new Error("Network response was not ok");var o=await a.json();if(!o.success)throw new Error(o.message||"Error sending inquiry");alert("Cererea dvs. a fost trimisÄƒ cu succes!"),this.reset(),n()}catch(e){alert("A apÄƒrut o eroare. VÄƒ rugÄƒm Ã®ncercaÈ›i din nou."),console.error("Form submission error:",e)}finally{e.disabled=!1}})});